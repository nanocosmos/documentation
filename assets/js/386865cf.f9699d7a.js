"use strict";(self.webpackChunknanocosomos_documentation=self.webpackChunknanocosomos_documentation||[]).push([[792],{95788:(e,t,n)=>{n.d(t,{Iu:()=>p,yg:()=>u});var a=n(11504);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(n),c=i,u=m["".concat(s,".").concat(c)]||m[c]||g[c]||r;return n?a.createElement(u,o(o({ref:t},p),{},{components:n})):a.createElement(u,o({ref:t},p))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:i,o[1]=l;for(var d=2;d<r;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},79308:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>g,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var a=n(45072),i=(n(11504),n(95788));const r={id:"nanostream_android_developer_manual_streaming",title:"Streaming Media",sidebar_label:"Streaming Media"},o=void 0,l={unversionedId:"nanostream/android/nanostream_android_developer_manual_streaming",id:"nanostream/android/nanostream_android_developer_manual_streaming",title:"Streaming Media",description:"Resolution, Aspect Ratio and Orientation",source:"@site/docs/nanostream/android/nanostream_android_developer_manual_streaming.md",sourceDirName:"nanostream/android",slug:"/nanostream/android/nanostream_android_developer_manual_streaming",permalink:"/docs/nanostream/android/nanostream_android_developer_manual_streaming",draft:!1,tags:[],version:"current",lastUpdatedAt:1707150098,formattedLastUpdatedAt:"Feb 5, 2024",frontMatter:{id:"nanostream_android_developer_manual_streaming",title:"Streaming Media",sidebar_label:"Streaming Media"},sidebar:"nanoStream Apps & SDKs",previous:{title:"Playback",permalink:"/docs/nanostream/android/nanostream_android_developer_manual_playback"},next:{title:"Sample",permalink:"/docs/nanostream/android/nanostream_android_developer_manual_sample"}},s={},d=[{value:"Resolution, Aspect Ratio and Orientation",id:"resolution-aspect-ratio-and-orientation",level:2},{value:"Resolution",id:"resolution",level:3},{value:"Aspect Ratio",id:"aspect-ratio",level:3},{value:"Supported Aspect Ratios",id:"supported-aspect-ratios",level:4},{value:"Orientation",id:"orientation",level:3},{value:"Supported Orientations",id:"supported-orientations",level:4},{value:"Example Combinations of Aspect Ratios and Orientations",id:"example-combinations-of-aspect-ratios-and-orientations",level:3},{value:"Example",id:"example",level:3},{value:"Implementation Example",id:"implementation-example",level:3},{value:"Stream Type",id:"stream-type",level:2},{value:"Implementation Example",id:"implementation-example-1",level:3},{value:"Server Authentication",id:"server-authentication",level:2},{value:"Implementation Example",id:"implementation-example-2",level:3},{value:"Local Recording",id:"local-recording",level:2},{value:"Description",id:"description",level:3},{value:"Steps to configure MP4 recording",id:"steps-to-configure-mp4-recording",level:3},{value:"setRecordMp4(boolean)",id:"setrecordmp4boolean",level:3},{value:"setMp4Path(String)",id:"setmp4pathstring",level:3},{value:"Android Permission",id:"android-permission",level:3},{value:"Android 6.0",id:"android-60",level:4},{value:"Implementation Example",id:"implementation-example-3",level:3},{value:"Adaptive Bitrate Streaming",id:"adaptive-bitrate-streaming",level:2},{value:"Implementation Example",id:"implementation-example-4",level:3},{value:"Measuring the available bandwidth",id:"measuring-the-available-bandwidth",level:3},{value:"Implementation Example",id:"implementation-example-5",level:4},{value:"Implementation Example",id:"implementation-example-6",level:3},{value:"Camera Zoom",id:"camera-zoom",level:2},{value:"Description",id:"description-1",level:3},{value:"getZoomRatios()",id:"getzoomratios",level:4},{value:"setZoom(int)",id:"setzoomint",level:4},{value:"Zoom Behavior on Camera Switch",id:"zoom-behavior-on-camera-switch",level:4},{value:"Implementation Example",id:"implementation-example-7",level:4},{value:"Camera Focus",id:"camera-focus",level:2},{value:"Description",id:"description-2",level:3},{value:"Parameter List",id:"parameter-list",level:3},{value:"FocusCallback interface",id:"focuscallback-interface",level:3},{value:"Implementation Example",id:"implementation-example-8",level:3},{value:"DeviceProperties",id:"deviceproperties",level:2},{value:"Description",id:"description-3",level:3},{value:"Implementation Example",id:"implementation-example-9",level:3}],p={toc:d},m="wrapper";function g(e){let{components:t,...r}=e;return(0,i.yg)(m,(0,a.c)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h2",{id:"resolution-aspect-ratio-and-orientation"},"Resolution, Aspect Ratio and Orientation"),(0,i.yg)("h3",{id:"resolution"},"Resolution"),(0,i.yg)("p",null,"Resolution means the native resolution of the camera (input). In the most situations this will be the same for the output.\nTo set the resolution there is a function in the ",(0,i.yg)("inlineCode",{parentName:"p"},"VideoSettings")," object called ",(0,i.yg)("inlineCode",{parentName:"p"},"setResolution(Resolution res)"),". If you set a resolution that the\ndevice doesn't support, nanoStream will automatically switch to the nearest resolution available on the device. A list of supported resolutions for the current video source can be obtained from ",(0,i.yg)("inlineCode",{parentName:"p"},"getCapabilities().listAvailableVideoResolutions()"),"\non the ",(0,i.yg)("inlineCode",{parentName:"p"},"nanoStream")," object."),(0,i.yg)("h3",{id:"aspect-ratio"},"Aspect Ratio"),(0,i.yg)("p",null,"Aspect ratio means the aspect ratio of the outgoing stream. The aspect ratio determines if the input video needs to be cropped.\nThe aspect ratio can be set through the ",(0,i.yg)("inlineCode",{parentName:"p"},"setAspectRatio(AspectRatio aspectRatio)")," function on the ",(0,i.yg)("inlineCode",{parentName:"p"},"VideoSettings")," object."),(0,i.yg)("h4",{id:"supported-aspect-ratios"},"Supported Aspect Ratios"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Aspect Ratio"),(0,i.yg)("th",{parentName:"tr",align:null},"AspectRatio value"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"Keep Input"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"AspectRatio.RATIO_KEEP_INPUT"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"1:1"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"AspectRatio.RATIO_1_1"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"4:3"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"AspectRatio.RATIO_4_3"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"16:9"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"AspectRatio.RATIO_16_9"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"3:4"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"AspectRatio.RATIO_3_4"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"9:16"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"AspectRatio.RATIO_9_16"))))),(0,i.yg)("h3",{id:"orientation"},"Orientation"),(0,i.yg)("p",null,"The default stream orientation is landscape. If you switch to portrait the resolution will swap width and height, e.g. from ",(0,i.yg)("inlineCode",{parentName:"p"},"640x480")," to ",(0,i.yg)("inlineCode",{parentName:"p"},"480x640"),".\nYou can set the stream orientation on the ",(0,i.yg)("inlineCode",{parentName:"p"},"nanoStream")," object with the ",(0,i.yg)("inlineCode",{parentName:"p"},"setStreamRotation")," function. The stream orientation needs to be set\nbefore starting the stream, it is not possible to switch the orientation during the stream."),(0,i.yg)("h4",{id:"supported-orientations"},"Supported Orientations"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Orientation"),(0,i.yg)("th",{parentName:"tr",align:null},"Rotation Value"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"Landscape"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"Rotation.ROTATION_0"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"Portrait"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"Rotation.ROTATION_90"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"Landscape Upside Down"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"Rotation.ROTATION_180"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"td"},(0,i.yg)("inlineCode",{parentName:"strong"},"Portrait Upside Down"))),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"Rotation.ROTATION_270"))))),(0,i.yg)("h3",{id:"example-combinations-of-aspect-ratios-and-orientations"},"Example Combinations of Aspect Ratios and Orientations"),(0,i.yg)("p",null,"The input resolution is set to ",(0,i.yg)("inlineCode",{parentName:"p"},"640x480")," here.\nThe red rectangle marks up the active area that is included in the output stream."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Orientation"),(0,i.yg)("th",{parentName:"tr",align:null},"Aspect Ratio"),(0,i.yg)("th",{parentName:"tr",align:null},"Stream Area"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Portrait",(0,i.yg)("sup",null,(0,i.yg)("a",{parentName:"td",href:"#fnAS1"},"1"))),(0,i.yg)("td",{parentName:"tr",align:null},"Keep Input"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(28460).c,width:"782",height:"1395"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Portrait",(0,i.yg)("sup",null,(0,i.yg)("a",{parentName:"td",href:"#fnAS1"},"1"))),(0,i.yg)("td",{parentName:"tr",align:null},"4:3"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(53688).c,width:"782",height:"1395"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Portrait",(0,i.yg)("sup",null,(0,i.yg)("a",{parentName:"td",href:"#fnAS1"},"1"))),(0,i.yg)("td",{parentName:"tr",align:null},"3:4"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(51200).c,width:"782",height:"1395"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Portrait",(0,i.yg)("sup",null,(0,i.yg)("a",{parentName:"td",href:"#fnAS1"},"1"))),(0,i.yg)("td",{parentName:"tr",align:null},"16:9"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(82696).c,width:"782",height:"1395"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Portrait",(0,i.yg)("sup",null,(0,i.yg)("a",{parentName:"td",href:"#fnAS1"},"1"))),(0,i.yg)("td",{parentName:"tr",align:null},"9:16"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(40396).c,width:"782",height:"1395"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Landscape"),(0,i.yg)("td",{parentName:"tr",align:null},"Keep Input"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(20880).c,width:"2499",height:"1262"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Landscape"),(0,i.yg)("td",{parentName:"tr",align:null},"4:3"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(62264).c,width:"2499",height:"1262"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Landscape"),(0,i.yg)("td",{parentName:"tr",align:null},"3:4"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(56916).c,width:"2499",height:"1262"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Landscape"),(0,i.yg)("td",{parentName:"tr",align:null},"16:9"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(19940).c,width:"2499",height:"1262"}))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Landscape"),(0,i.yg)("td",{parentName:"tr",align:null},"9:16"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("img",{alt:"Screenshot",src:n(79324).c,width:"2499",height:"1262"}))))),(0,i.yg)("a",{name:"fnAS1"},"1"),": In this sample APP we crop the preview so it doesn't look ugly, so the stream is actually larger then the preview.",(0,i.yg)("h3",{id:"example"},"Example"),(0,i.yg)("p",null,"If you want to stream with a resolution of ",(0,i.yg)("inlineCode",{parentName:"p"},"640x360")," but your device doesn't supports this resolution, you need to crop the resolution from ",(0,i.yg)("inlineCode",{parentName:"p"},"640x480")," (this resolution is supported by the most devices) to ",(0,i.yg)("inlineCode",{parentName:"p"},"640x360"),".\nThis can be done through the aspect ratio, so you need to set the aspect ratio to ",(0,i.yg)("inlineCode",{parentName:"p"},"16:9")," to stream with a resolution of ",(0,i.yg)("inlineCode",{parentName:"p"},"640x360"),"."),(0,i.yg)("h3",{id:"implementation-example"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"public class MainActivity {\n    ...\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n      super.onCreate(savedInstanceState);\n      nanoStreamSettings nss = new nanoStreamSettings();\n      VideoSettings vs = new VideoSettings();\n      ...\n      vs.setResolution(new Resolution(640, 480)); // default value\n      vs.setAspectRatio(AspectRatio.RATIO_16_9); // default value is AspectRatio.KEEP_INPUT\n      ...\n      streamLib = new nanoStream(nss);\n      streaLib.init();\n\n      streamLib.setStreamRotation(Rotation.ROTATION_0); // default value\n      ...\n    }\n    ...\n}\n")),(0,i.yg)("h2",{id:"stream-type"},"Stream Type"),(0,i.yg)("p",null,"The SDK supports differnet streaming modes:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Video and Audio"),(0,i.yg)("li",{parentName:"ul"},"Video only"),(0,i.yg)("li",{parentName:"ul"},"Audio only")),(0,i.yg)("p",null,"You can en/disable Video/Audio in the ",(0,i.yg)("inlineCode",{parentName:"p"},"nanoStreamSettings.object")),(0,i.yg)("h3",{id:"implementation-example-1"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"nanoStreamSettings nss = new nanoStreamSettings();\nnss.setHaveVideo(true); // false\nnss.setHaveAudio(true); // false\n")),(0,i.yg)("h2",{id:"server-authentication"},"Server Authentication"),(0,i.yg)("p",null,"In case authentication is required, the credentials can be set on the ",(0,i.yg)("inlineCode",{parentName:"p"},"nanoStreamSettings")," object."),(0,i.yg)("h3",{id:"implementation-example-2"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},'nanoStreamSettings nss = new nanoStreamSettings();\nnss.setAuthUser("user");\nnss.setAuthPassword("password");\n')),(0,i.yg)("h2",{id:"local-recording"},"Local Recording"),(0,i.yg)("h3",{id:"description"},"Description"),(0,i.yg)("p",null,"The nanoStream Android SDK supports local file recording on the device in MP4 format. This document describes how to enable and configure nanoStream for local recording."),(0,i.yg)("h3",{id:"steps-to-configure-mp4-recording"},"Steps to configure MP4 recording"),(0,i.yg)("p",null,"MP4 recording can be configured with two function calls on a nanoStreamSettings object."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Enabling MP4 recording: ",(0,i.yg)("inlineCode",{parentName:"li"},"setRecordMp4(boolean)")),(0,i.yg)("li",{parentName:"ul"},"Setting up the file path: ",(0,i.yg)("inlineCode",{parentName:"li"},"setMp4Path(String)"))),(0,i.yg)("h3",{id:"setrecordmp4boolean"},"setRecordMp4(boolean)"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"setRecordMp4")," function takes a boolean as parameter to enable/disable the recording function."),(0,i.yg)("h3",{id:"setmp4pathstring"},"setMp4Path(String)"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"setMp4Path")," function takes a String as parameter. This string needs to be a valid file path (e.g. ",(0,i.yg)("inlineCode",{parentName:"p"},"/sdcard/test.mp4"),"). It is recommended to use the ",(0,i.yg)("inlineCode",{parentName:"p"},"getExternalStorageDirectory")," or ",(0,i.yg)("inlineCode",{parentName:"p"},"getExternalStoragePublicDirectory")," functions from the ","[Android Enviroment][8928e181]"," API, and add a file name to the returned path. Please find the code snippet below as an example."),(0,i.yg)("h3",{id:"android-permission"},"Android Permission"),(0,i.yg)("p",null,"To be able to write to an external file path your Android app needs the following permissions to be added to the app manifest (",(0,i.yg)("inlineCode",{parentName:"p"},"AndroidMainfest.xml"),")."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-xml"},'<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />\n<uses-permission android:name="android.permission.STORAGE" />\n')),(0,i.yg)("h4",{id:"android-60"},"Android 6.0"),(0,i.yg)("p",null,"Due to the new permission handling in Android 6 (M) writing to external directories (DCIM) requires a permission by user. Writing to the applications own data directory (/Android/data/com.companyname.appname/) is not restricted."),(0,i.yg)("h3",{id:"implementation-example-3"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},'File externalFilePath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM);\nFile filePath = new File(externalFilePath, "myMp4File.mp4");\nString mp4FilePath = filePath.getAbsolutePath();\n\nnanoStreamSettings nss = new nanoStreamSettings();\nnss.setRecordMp4(true);\nnss.setMp4Path(mp4FilePath);\n')),(0,i.yg)("h2",{id:"adaptive-bitrate-streaming"},"Adaptive Bitrate Streaming"),(0,i.yg)("p",null,"By using the Adaptive Bitrate Control (ABC) the stream will automatically adjust to changes of the bandwidth. There are four modes available:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"DISABLED"),": The Adaptive Bitrate Control is disabled."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"QUALITY_DEGRADE"),": The video quality will be changed if the bandwidth changes. For instance, if not enough bandwidth is available, the video bitrate will be decreased, which in turn degrades the video quality."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"FRAME_DROP"),": Low bandwidth is compensated by decreasing the framerate (FPS), but maintaining the video qualtiy."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"QUALITY_DEGRADE_AND_FRAME_DROP"),": The video quality and the framerate (FPS) decreased if the not enough bandwidth is available.")),(0,i.yg)("p",null,"Make sure to set the ABC settings before a stream is started."),(0,i.yg)("h3",{id:"implementation-example-4"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"private AdaptiveBitrateControlSettings.AdaptiveBitrateControlMode abcMode = AdaptiveBitrateControlSettings.AdaptiveBitrateControlMode.QUALITY_DEGRADE_AND_FRAME_DROP;\nprivate int videoBitrate = 500000;\n\nprivate void initStreamLib() {\n  AdaptiveBitrateControlSettings abcSettings = new AdaptiveBitrateControlSettings(abcMode);\n  abcSettings.SetMaximumBitrate((int)(videoBitrate * 1.5));\n\n  nanoStreamSettings nss = new nanoStreamSettings();\n  nss.setAbcSettings(abcSettings);\n}\n")),(0,i.yg)("h3",{id:"measuring-the-available-bandwidth"},"Measuring the available bandwidth"),(0,i.yg)("p",null,"For measuring the available bandwidth you can use the method ",(0,i.yg)("inlineCode",{parentName:"p"},"runBandwidthCheck"),". After the check finished, the result can be used to set the bitrate for the nanoStream object.\nThe check measures the bandwidth by running a test stream to the server.\nThe BandwidthCheck Class has three public functions:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"runBandwidthCheck(BandwidthCheckSettings settings, BandwidthCheckResultCallback callback())")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"forceStop()")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"abort()"))),(0,i.yg)("p",null,"There is a BandwidthCheckSettings Class, the constructor creates a standard object of BandwidthCheckSettings, with the following settings:"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:"left"},"property"),(0,i.yg)("th",{parentName:"tr",align:"left"},"default values"),(0,i.yg)("th",{parentName:"tr",align:"left"},"meaning"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"prerollSeconds")),(0,i.yg)("td",{parentName:"tr",align:"left"},"1 (in sec.)"),(0,i.yg)("td",{parentName:"tr",align:"left"},"this is the pre roll time to connect to the server")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"runTime")),(0,i.yg)("td",{parentName:"tr",align:"left"},"5 (in sec.)"),(0,i.yg)("td",{parentName:"tr",align:"left"},"the run time of the bandwidth check")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"maxBitrate")),(0,i.yg)("td",{parentName:"tr",align:"left"},"3000000 (bit/s = 3 MBit/s)"),(0,i.yg)("td",{parentName:"tr",align:"left"},"the maximum bit rate for the bandwidth check")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"rtmpUrl")),(0,i.yg)("td",{parentName:"tr",align:"left"},"empty"),(0,i.yg)("td",{parentName:"tr",align:"left"},"the rtmp url for the bandwidth check")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"streamId")),(0,i.yg)("td",{parentName:"tr",align:"left"},"empty"),(0,i.yg)("td",{parentName:"tr",align:"left"},"the stream id for the bandwidth check")))),(0,i.yg)("p",null,"With this settings you can call the runBandwidthCheck methode, the second parameter is the callback for the results. This callback class has a finished method that will be called after bandwidth check is done.\nThe finished method has one parameter from type BandwidthCheckResult, this object has 6 getter methods:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"getAverageBitrate()")," // the average measured bandwidth"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"getMedianBitrate()")," // the median measured bandwidth"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"getMaxBitrate()")," // the maximum measured bandwidth"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"getMinBitrate()")," // the minimum measured bandwidth"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"getRunTimeMS()")," // the run time in ms"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"getErrorCode()")," // the error code if all is ok this is nanoResults.N_OK (all error codes can be found in the nanoStream API Reference documentation for nanoResults)")),(0,i.yg)("p",null,"The forceStop call stops the bandwidth check and will return the results that where measured until then. The abort call stops the bandwidth check but don't return any results."),(0,i.yg)("p",null,"The bandwidth check, sends a special type of metadata that will not be recorded on the Streaming Server."),(0,i.yg)("h4",{id:"implementation-example-5"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},'private BandwidthCheck bwCheck = null;\n\nprivate class CustomBandwidthCheckResultCallback implements BandwidthCheckResultCallback {\n  @Override\n  public void finished(final BandwidthCheckResult bandwidthCheckResult) {\n    Log.d(TAG, "BandwidthCheck results: " +\n      "\\n\\tAverage Bitrate (kBit/s): " + bandwidthCheckResult.getAverageBitrate() / 1000 +\n      "\\n\\tMedian Bitrate  (kBit/s): " + bandwidthCheckResult.getMedianBitrate() / 1000 +\n      "\\n\\tMax Bitrate     (kBit/s): " + bandwidthCheckResult.getMaxBitrate() / 1000 +\n      "\\n\\tMin Bitrate     (kBit/s): " + bandwidthCheckResult.getMinBitrate() / 1000 +\n      "\\n\\tRun Time        (ms)    : " + bandwidthCheckResult.getRunTimeMS());\n  }\n}\n\nprivate void initBandwidthCheck() {\n  if(null == bwCheck) {\n    BandwidthCheckSettings settings = new BandwidthCheckSettings();\n    settings.setRtmpUrl(serverUrl);\n    settings.setStreamId(streamName);\n    bwCheck = new BandwidthCheck();\n    bwCheck.runBandwidthCheck(settings, new CustomBandwidthCheckResultCallback());\n  }\n}\n')),(0,i.yg)("p",null,"##Snapshot"),(0,i.yg)("p",null,"To get a snapshot (image) of the current preview/stream, the method ",(0,i.yg)("inlineCode",{parentName:"p"},"takeSnapshot")," can be used. This is a non blocking function, for the result you need to implement the ",(0,i.yg)("inlineCode",{parentName:"p"},"SnapshotCallback")," interface. The snapshot returns as a ",(0,i.yg)("inlineCode",{parentName:"p"},"base64")," encoded ",(0,i.yg)("inlineCode",{parentName:"p"},"JPEG")),(0,i.yg)("h3",{id:"implementation-example-6"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},'private class CustomSnapshotCallback implements SnapshotCallback {\n  @Override\n  void onSuccess(String arg0){\n    // do something with the base64 encoded JPEG.\n  }\n\n  @Override\n void onFailure(){\n   Log.d(TAG, "takeSnapshot() failed!")\n }\n}\nprivate void shapshot() {\n  streamLib.takeSnapshot(new CustomSnapshotCallback());\n}\n')),(0,i.yg)("h2",{id:"camera-zoom"},"Camera Zoom"),(0,i.yg)("h3",{id:"description-1"},"Description"),(0,i.yg)("p",null,"The nanoStream Android SDK supports camera zoom, if the internal camera supports it. Therefor there are a few functions, the most important are:"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:"left"},"Function"),(0,i.yg)("th",{parentName:"tr",align:"left"},"Return Type"),(0,i.yg)("th",{parentName:"tr",align:"left"},"returns"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"hasZoom()")),(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"boolean")),(0,i.yg)("td",{parentName:"tr",align:"left"},"true if zoom is supported by the video source/ device")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"getZoomRatios()")),(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"List<Integer>")),(0,i.yg)("td",{parentName:"tr",align:"left"},"list with of ale zoom ratios")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"getZoom()")),(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"int")),(0,i.yg)("td",{parentName:"tr",align:"left"},"the index of the ",(0,i.yg)("inlineCode",{parentName:"td"},"List<Integer>")," that returned from ",(0,i.yg)("inlineCode",{parentName:"td"},"getZoomRatios()"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"setZoom(int)")),(0,i.yg)("td",{parentName:"tr",align:"left"},(0,i.yg)("inlineCode",{parentName:"td"},"int")),(0,i.yg)("td",{parentName:"tr",align:"left"},"the new index of the ",(0,i.yg)("inlineCode",{parentName:"td"},"List<Integer>")," that returned from ",(0,i.yg)("inlineCode",{parentName:"td"},"getZoomRatios()"))))),(0,i.yg)("p",null,"It is recommended to use pinch to zoom, therefor you need to implement a ",(0,i.yg)("inlineCode",{parentName:"p"},"ScaleGestureDetector.SimpleOnScaleGestureListener"),", and a ",(0,i.yg)("inlineCode",{parentName:"p"},"pinch2zoom")," function, that takes the ",(0,i.yg)("inlineCode",{parentName:"p"},"scalefactor")," from the ",(0,i.yg)("inlineCode",{parentName:"p"},"SimpleOnScaleGestureListener")," as a int parameter, take a look at the ","[Implementation Example][ef1c8421]","."),(0,i.yg)("h4",{id:"getzoomratios"},"getZoomRatios()"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"getZoomRatios()")," returns a List of Integer values, this values are the zoom ratios in ",(0,i.yg)("inlineCode",{parentName:"p"},"1/100")," increments (e.g. a zoom of ",(0,i.yg)("inlineCode",{parentName:"p"},"3.2x")," is returned as ",(0,i.yg)("inlineCode",{parentName:"p"},"320"),")."),(0,i.yg)("h4",{id:"setzoomint"},"setZoom(int)"),(0,i.yg)("p",null,"The int parameter from ",(0,i.yg)("inlineCode",{parentName:"p"},"setZoom(int zoom)")," is the index of zoom ratios that returns ",(0,i.yg)("inlineCode",{parentName:"p"},"getZoomRatios()"),"."),(0,i.yg)("h4",{id:"zoom-behavior-on-camera-switch"},"Zoom Behavior on Camera Switch"),(0,i.yg)("p",null,"During a camera switch (e.g. from back to front) the zoom remains unaffected."),(0,i.yg)("h4",{id:"implementation-example-7"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"public class MainActivity extends Activity {\n  private ScaleGestureDetector scaleGestureDetector;\n  private List<Integer> mZoomRatios = null;\n\n  private nanoStream streamLib = null;\n\n  @Override\n  protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n\n    nanoStreamSettings nss = new nanoStreamSettings();\n    // configure nanoStreamSettings\n\n    streamLib = new nanoStream(nss);\n\n    if(streamLib.hasZoom()) {\n      mZoomRatios = streamLib.getZoomRatio();\n    }\n\n    if(null == scaleGestureDetector) {\n      scaleGestureDetector = new ScaleGestureDetector(this, new ScaleGestureListener());\n    }\n  }\n\n  @Override\n  public boolean onTouchEvent(MotionEvent event)\n  {\n    if (scaleGestureDetector != null)\n    {\n      scaleGestureDetector.onTouchEvent(event);\n    }\n    return true;\n  }\n\n  private class ScaleGestureListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {\n    @Override\n    public boolean onScale(ScaleGestureDetector detector) {\n      if(null != streamLib) {\n        if (streamLib.hasZoom()) {\n          pinch2Zoom(detector.getScaleFactor());\n        }\n      }\n      return true;\n    }\n  }\n\n  public void pinch2Zoom(float scaleFactor) {\n    if (streamLib.hasZoom() && null != mZoomRatios) {\n      int zoomFactor = streamLib.getZoom();\n      float zoomRatio = mZoomRatios.get(zoomFactor) / 100f;\n      zoomRatio *= scaleFactor;\n      if (zoomRatio > 1.0f) {\n        if (scaleFactor > 1.0f) {\n          for (int i = zoomFactor; i < mZoomRatios.size(); i++) {\n            Double zoom = mZoomRatios.get(i) / 100.0;\n            if (zoom >= zoomRatio) {\n              streamLib.setZoom(i);\n              break;\n            }\n          }\n        } else {\n          for (int i = zoomFactor; i > 0; i--) {\n            Double zoom = mZoomRatios.get(i) / 100.0;\n            if (zoom <= zoomRatio) {\n              streamLib.setZoom(i);\n              break;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n")),(0,i.yg)("h2",{id:"camera-focus"},"Camera Focus"),(0,i.yg)("h3",{id:"description-2"},"Description"),(0,i.yg)("p",null,"The nanoStream Android SDK supports camera focus and focus lock, if the internal cameras supports them. There are two non-blocking functions"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"setFocusArea(int focusWidth, int focusHeight, float areaMultiple, int x, int y, int previewWidth, int previewHeight, int weigh)\nsetFocusLockArea(int focusWidth, int focusHeight, float areaMultiple, int x, int y, int previewWidth, int previewHeight, int weigh)\n")),(0,i.yg)("p",null,"through the"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"addFocusCalback(FocusCallback callback)\nremoveFocusCalback(FocusCallback callback)\n")),(0,i.yg)("p",null,"you can attach or remove a ",(0,i.yg)("inlineCode",{parentName:"p"},"FocusCallback")," listener.\nTo check if your device supports focus call the function"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"isFocusSupported()\n")),(0,i.yg)("p",null,"which will return ",(0,i.yg)("inlineCode",{parentName:"p"},"true")," or ",(0,i.yg)("inlineCode",{parentName:"p"},"false"),"."),(0,i.yg)("h3",{id:"parameter-list"},"Parameter List"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"th"},"Parameter name")),(0,i.yg)("th",{parentName:"tr",align:null},(0,i.yg)("strong",{parentName:"th"},"meaning")))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"focusWidth")),(0,i.yg)("td",{parentName:"tr",align:null},"the focus Area width")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"focusHeight")),(0,i.yg)("td",{parentName:"tr",align:null},"the focus Area height")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"areaMultiple")),(0,i.yg)("td",{parentName:"tr",align:null},"a Multiple for the focus area (default: 1f)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"x")),(0,i.yg)("td",{parentName:"tr",align:null},"the x position on the Screen")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"y")),(0,i.yg)("td",{parentName:"tr",align:null},"the y position on the Screen")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"previewWidth")),(0,i.yg)("td",{parentName:"tr",align:null},"the width of the preview")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"previewHeight")),(0,i.yg)("td",{parentName:"tr",align:null},"the height of the preview")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"weight")),(0,i.yg)("td",{parentName:"tr",align:null},"the weight of the area must be range from 1 to 1000")))),(0,i.yg)("h3",{id:"focuscallback-interface"},"FocusCallback interface"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"FocusCallback")," interface has three abstract functions"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"onSuccess()\nonSuccess(Rect rect, Boolean focusLock)\nonFailure()\n")),(0,i.yg)("h3",{id:"implementation-example-8"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},'public class MainActifity extens Actifity implements FocusCallback {\n  private GestureDetector gestureDetector;\n  private nanoStream streamLib = null;\n\n  @Override\n  protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    streamLib = new nanoStream(new nanoStreamSettings());\n    if(streamLib.isFocusSupported()) {\n      gestureDetector = new GestureDetector(this, new GestureListener());\n    }\n    ...\n  }\n\n  @Override\n  public boolean onTouchEvent(MotionEvent event)\n  {\n    if (gestureDetector != null)\n    {\n        gestureDetector.onTouchEvent(event);\n    }\n    return true;\n  }\n  ....\n  private class GestureListener implements OnGestureListener {\n\n     @Override\n     public boolean onSingleTapUp(MotionEvent e)\n     {\n         if (streamLib != null)\n         {\n             streamLib.setFocusArea(300, 300, 1f, (int) e.getX(), (int) e.getY(), surface.getWidth(), surface.getHeight(), 1000);\n         }\n         return true;\n     }\n\n    @Override\n     public void onLongPress(MotionEvent e)\n     {\n         if (streamLib != null)\n         {\n             streamLib.setFocusLockArea(300, 300, 1f, (int) e.getX(), (int) e.getY(), surface.getWidth(), surface.getHeight(), 1000);\n         }\n     }\n   }\n\n   @Override\n    public void onSuccess(Rect rect, Boolean aBoolean) {\n      Log.i(TAG, "focus success");\n    }\n\n    @Override\n    public void onFailure() {\n      Log.i(TAG, "focus failed");\n    }\n}\n')),(0,i.yg)("h2",{id:"deviceproperties"},"DeviceProperties"),(0,i.yg)("p",null,"Before Android 4.3 there was no obligation for Android hardware manufacturers to pass the video related parts of the CTS (Compatibility Test Suite).\nTherefore some Android 4.1 and 4.2 Devices show non standard behaviour in regard to color format definitions and representation of video frames in memory. This could lead to issues in the video stream like switched red and blue colors, dislocated color components or a green bar at the bottom of the video frame. nanoStream Android now provides the functionality to detect and compensate common issues related to this."),(0,i.yg)("h3",{id:"description-3"},"Description"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"nanoStream.getDeviceProperties()")," is a static function that is running a test on the device hardware to detect non standard behaviour and returning a DeviceProperties object containing the result.\n",(0,i.yg)("inlineCode",{parentName:"p"},"DeviceProperties.getFlags()")," returns the test result as an integer value that can be stored in the application preferences, to avoid running the device test on every app start.\nDeviceProperties can be applied to a new nanoStream instance by calling ",(0,i.yg)("inlineCode",{parentName:"p"},"nanoStream.setDeviceProperties(DeviceProperties)"),".\nWe recommend to call ",(0,i.yg)("inlineCode",{parentName:"p"},"getDeviceProperties()")," in a background thread during the first app start on a pre 4.3 device, because the call is blocking and might last up to 5 seconds on older/weaker devices.\nWe also recommend to store the OS version in the preferences, to be able to detect OS updates and to eventually rerun the device test or stop setting the DeviceProperties if the new OS is 4.3 or higher."),(0,i.yg)("h3",{id:"implementation-example-9"},"Implementation Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},'public class App extends Application\n{\n    private static DeviceProperties deviceProp = null;\n\n    public void onCreate()\n    {\n        super.onCreate();\n\n        Thread chkThread = new Thread(new Runnable()\n        {\n            @Override\n            public void run()\n            {\n                try\n                {\n                    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());\n                    int curApiVer = android.os.Build.VERSION.SDK_INT;\n                    int curAppVer = getPackageManager().getPackageInfo(getPackageName(), 0).versionCode;\n                    int curEncVer = DeviceProperties.VERSION;\n\n                    int oldApiVer = prefs.getInt("Pref_Android_API", 0);\n                    int oldAppVer = prefs.getInt("Pref_App_Version", 0);\n                    int oldChkVer = prefs.getInt("Pref_Check_Version", 0);\n                    int oldChkResult = prefs.getInt("Pref_Check_Result", -1);\n\n                    if (((oldApiVer * oldAppVer * oldApiVer) == 0)\n                    || (oldApiVer < curApiVer)\n                    || (oldAppVer < curAppVer)\n                    || (oldChkVer < curEncVer)\n                    || oldChkResult < 0)\n                    {\n\n                        Editor edit = prefs.edit();\n                        edit.putInt("Pref_Android_API", curApiVer);\n                        edit.putInt("Pref_App_Version", curAppVer);\n\n                        /* Run  device check */\n                        try\n                        {\n                            deviceProp = nanoStream.getDeviceProperties();\n\n                            edit.putInt("Pref_Check_Result", deviceProp.getFlags());\n                            edit.putInt("Pref_Check_Version", deviceProp.getVersion());\n                            edit.commit();\n                        }\n                        catch (RuntimeException e)\n                        {\n                            Log.d("Device Check failed", e.toString());\n                            edit.putInt("Pref_Check_Result", -1);\n                            edit.putInt("Pref_Check_Version", 0);\n                            edit.commit();\n                        }\n\n                    }\n                    else\n                    {\n                        deviceProp = new DeviceProperties(oldChkResult);\n                    }\n\n                    Log.d("Device Properties: ", deviceProp.toString());\n                }\n                catch (Exception e)\n                {\n                    Log.d(this.getClass().getName(), "Device Check Runnable");\n                    e.printStackTrace();\n                }\n            }\n        });\n\n        if (android.os.Build.VERSION.SDK_INT < 18)\n        {\n            chkThread.start();\n        }\n\n        ...\n    }\n\n    public static DeviceProperties getDeviceProperties()\n    {\n        return deviceProp;\n    }\n}\n')),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-java"},"public class MainActivity extends Activity implements NanostreamEventListener\n{\n    ...\n    @Override\n    protected void onCreate(Bundle savedInstanceState)\n    {\n        try\n        {\n            nanoStreamSettings nss = new nanoStreamSettings();\n\n            streamLib = new nanoStream(nss);\n\n            DeviceProperties deviceProperties = App.getDeviceProperties();\n\n            if(null != streamLib && null != deviceProperties)\n            {\n                streamLib.setDeviceProperties(deviceProperties);\n            }\n        }\n        catch(NanostreamException en)\n        {\n            Toast.makeText(getApplicationContext(), en.toString(), Toast.LENGTH_LONG).show();\n        }\n    }\n    ...\n}\n}\n")))}g.isMDXComponent=!0},19940:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/landscape_16_9-b24e5f3e54ce0b31483fa08a980410c5.png"},56916:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/landscape_3_4-36870b120ce9223b48182175877bd1a2.png"},62264:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/landscape_4_3-b5f81691b28890d7385d945616ac388d.png"},79324:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/landscape_9_16-918822f0f2f4ead1a3de5cd4219b7109.png"},20880:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/landscape_keep_input-1e7e8bc79c50ac34564e56ff88ea9ae6.png"},82696:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/portrait_16_9-53395b41af4fd4695ee197b9e3315bf3.png"},51200:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/portrait_3_4-28d4fbfc48da1c4ad8607b9a66c4fc68.png"},53688:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/portrait_4_3-c7957a76d2d110052d25975467fb5733.png"},40396:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/portrait_9_16-5038ad4c6c84aa83a7aab390b2645f30.png"},28460:(e,t,n)=>{n.d(t,{c:()=>a});const a=n.p+"assets/images/portrait_keep_input-28d4fbfc48da1c4ad8607b9a66c4fc68.png"}}]);