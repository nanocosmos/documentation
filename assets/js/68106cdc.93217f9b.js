"use strict";(self.webpackChunknanocosomos_documentation=self.webpackChunknanocosomos_documentation||[]).push([[1384],{15680:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>c});var a=t(96540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),m=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=m(e.components);return a.createElement(l.Provider,{value:n},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},g=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=m(t),g=i,c=u["".concat(l,".").concat(g)]||u[g]||h[g]||r;return t?a.createElement(c,o(o({ref:n},p),{},{components:t})):a.createElement(c,o({ref:n},p))}));function c(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=g;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[u]="string"==typeof e?e:i,o[1]=s;for(var m=2;m<r;m++)o[m]=t[m];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}g.displayName="MDXCreateElement"},92844:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>m});var a=t(58168),i=(t(96540),t(15680));const r={id:"nanoplayer_feature_stream_switching",title:"Stream switching and ABR",sidebar_label:"Stream switching and ABR"},o=void 0,s={unversionedId:"nanoplayer/nanoplayer_feature_stream_switching",id:"nanoplayer/nanoplayer_feature_stream_switching",title:"Stream switching and ABR",description:"Multi stream configuration, integrated ABR and stream switching features",source:"@site/docs/nanoplayer/nanoplayer_feature_stream_switching.md",sourceDirName:"nanoplayer",slug:"/nanoplayer/nanoplayer_feature_stream_switching",permalink:"/docs/nanoplayer/nanoplayer_feature_stream_switching",draft:!1,tags:[],version:"current",lastUpdatedAt:1730389723,formattedLastUpdatedAt:"Oct 31, 2024",frontMatter:{id:"nanoplayer_feature_stream_switching",title:"Stream switching and ABR",sidebar_label:"Stream switching and ABR"},sidebar:"H5Live Player",previous:{title:"Secure playback with H5Live",permalink:"/docs/nanoplayer/nanoplayer_token_security"},next:{title:"Fullscreen API",permalink:"/docs/nanoplayer/nanoplayer_feature_fullscreen_api"}},l={},m=[{value:"Multi stream configuration, integrated ABR and stream switching features",id:"multi-stream-configuration-integrated-abr-and-stream-switching-features",level:2},{value:"Configuration changes",id:"configuration-changes",level:2},{value:"Stream configuration",id:"stream-configuration",level:3},{value:"ABR stream group configuration",id:"abr-stream-group-configuration",level:3},{value:"Single Stream configuration",id:"single-stream-configuration",level:3},{value:"Example OLD single stream configuration (DEPRECATED)",id:"example-old-single-stream-configuration-deprecated",level:4},{value:"Example single stream configuration",id:"example-new-single-stream-configuration",level:4},{value:"Multi stream configuration",id:"multi-stream-configuration",level:3},{value:"Example multi stream configuration (with ABR)",id:"example-multi-stream-configuration-with-abr",level:4},{value:"Example multi stream configuration (with ABR) and playback security",id:"example-multi-stream-configuration-with-abr-and-playback-security",level:4},{value:"Example bintu multi stream configuration (with ABR)",id:"example-bintu-multi-stream-configuration-with-abr",level:4},{value:"Example bintu multi stream configuration (with ABR) and playback security",id:"example-bintu-multi-stream-configuration-with-abr-and-playback-security",level:4},{value:"Switch options",id:"switch-options",level:3},{value:"Automatic bitrate adaption (ABR)",id:"automatic-bitrate-adaption-abr",level:2},{value:"How to use",id:"how-to-use",level:3},{value:"Example multi stream configuration (with ABR)",id:"example-multi-stream-configuration-with-abr-1",level:3},{value:"switchStream API",id:"switchstream-api",level:2},{value:"How to use",id:"how-to-use-1",level:3},{value:"switchStream events",id:"switchstream-events",level:3},{value:"Start Event",id:"start-event",level:4},{value:"Completion Events",id:"completion-events",level:4},{value:"Difference switchStream API / updateSource API",id:"difference-switchstream-api--updatesource-api",level:3},{value:"setAdaption API",id:"setadaption-api",level:2},{value:"Example to set automatic adaption",id:"example-to-set-automatic-adaption",level:3},{value:"Combined ABR and manual switching",id:"combined-abr-and-manual-switching",level:3}],p={toc:m},u="wrapper";function h(e){let{components:n,...t}=e;return(0,i.yg)(u,(0,a.A)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h2",{id:"multi-stream-configuration-integrated-abr-and-stream-switching-features"},"Multi stream configuration, integrated ABR and stream switching features"),(0,i.yg)("p",null,"The ",(0,i.yg)("strong",{parentName:"p"},"nanoStream H5Live Player Version 4.3")," is introducing new features related to stream switching and integrated adaptive bitrate playback enabling automatic and application/viewer controlled stream switching either separately or in combination.\nOne potential combined use case is a video quality selection offering options auto, high, medium, low to the viewer. "),(0,i.yg)("admonition",{title:"Important",type:"caution"},(0,i.yg)("p",{parentName:"admonition"}," To start using the stream switching feature make sure you're using the minimum required nanoStream H5Live Player version ",(0,i.yg)("strong",{parentName:"p"},"4.3")," !")),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"configuration-changes"},"Configuration changes"),(0,i.yg)("h3",{id:"stream-configuration"},"Stream configuration"),(0,i.yg)("p",null,"Whether you want to configure a ",(0,i.yg)("a",{parentName:"p",href:"#single-stream-configuration"},"single stream")," or ",(0,i.yg)("a",{parentName:"p",href:"#multi-stream-configuration"},"multiple streams")," you need to configure them inside the ",(0,i.yg)("inlineCode",{parentName:"p"},"config.source.entries")," object during the initial ",(0,i.yg)("inlineCode",{parentName:"p"},"setup")," call. "),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},"You can find more information on how to configure the player in our ",(0,i.yg)("a",{parentName:"p",href:"./nanoplayer_api#nanoplayerconfig--codeobjectcode"},"API documentation"),".")),(0,i.yg)("h3",{id:"abr-stream-group-configuration"},"ABR stream group configuration"),(0,i.yg)("p",null,"Please find more information about stream group configuration ",(0,i.yg)("a",{parentName:"p",href:"./nanoplayer_feature_stream_group_configuration"},"here"),"."),(0,i.yg)("h3",{id:"single-stream-configuration"},"Single Stream configuration"),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{parentName:"p",href:"#example-old-single-stream-configuration-deprecated"},"old pattern")," to configure a single stream is ",(0,i.yg)("strong",{parentName:"p"},"deprecated")," with this version! Please follow this ",(0,i.yg)("a",{parentName:"p",href:"#example-new-single-stream-configuration"},"new example")," to configure a single stream."),(0,i.yg)("h4",{id:"example-old-single-stream-configuration-deprecated"},"Example OLD single stream configuration (DEPRECATED)"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var config = {\n    "source" : {\n        "h5live": {\n            "rtmp": {\n                "url": "rtmp://bintu-play.nanocosmos.de/play",\n                "streamname": "XXXXX-YYYYY"\n            },\n            "server": {\n                "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n            },\n            "token": "",\n            "security": {}\n        }\n    },\n    "playback": {\n        ...\n    },\n    "style": {\n        ...\n    }\n};\n')),(0,i.yg)("h4",{id:"example-new-single-stream-configuration"},"Example single stream configuration"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var config = {\n    "source" : {\n        "entries": [\n            {\n                "index": 0,\n                "label": "high",\n                "tag": "this is a high quality stream",\n                "info": {\n                    "bitrate": 1200,\n                    "width": 1280,\n                    "height": 720,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-play.nanocosmos.de/play",\n                        "streamname": "XXXXX-YYYYY"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                        "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                        "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n                    },\n                    "token": "",\n                    "security": {}\n                },\n                "bintu": {}\n            }\n        ]\n    },\n    "playback": {\n        ...\n    },\n    "style": {\n        ...\n    }\n};\n')),(0,i.yg)("h3",{id:"multi-stream-configuration"},"Multi stream configuration"),(0,i.yg)("p",null,"You can configure a list of multiple streams inside the ",(0,i.yg)("inlineCode",{parentName:"p"},"config.source.entries")," object.\nDepending on the intended use case these can be: "),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"multi-bitrate renditions of the same content")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"multiple streams of different content. "))),(0,i.yg)("admonition",{title:"note ",type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"The nanoStream transcoding service allows a single stream to be delivered in different multi-bitrate qualities eg. high (original) transcoded in medium and low quality. ")),(0,i.yg)("p",null,"The entries need to be ordered by bitrate with ",(0,i.yg)("strong",{parentName:"p"},"index zero")," holding the ",(0,i.yg)("strong",{parentName:"p"},"highest bitrate"),".\nThe initial stream/rendition can be selected by assigning ",(0,i.yg)("inlineCode",{parentName:"p"},"config.source.startIndex")," to the index of an entry."),(0,i.yg)("admonition",{title:"Important",type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"Multi stream configuration is ",(0,i.yg)("strong",{parentName:"p"},"required")," for both the integrated ",(0,i.yg)("strong",{parentName:"p"},"ABR")," and also the ",(0,i.yg)("strong",{parentName:"p"},"switchStream")," feature!")),(0,i.yg)("h4",{id:"example-multi-stream-configuration-with-abr"},"Example multi stream configuration (with ABR)"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var config = {\n    "source" : {\n        "entries": [ // array of \'entry\' objects\n            {\n                "index": 0,\n                "label": "high",\n                "tag": "this is a high quality stream",\n                "info": {\n                    "bitrate": 1200,\n                    "width": 1280,\n                    "height": 720,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-play.nanocosmos.de/play",\n                        "streamname": "XXXXX-YYYY0"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                        "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                        "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n                    },\n                    "token": "",\n                    "security": {}\n                },\n                "bintu": {}\n            },\n            {\n                "index": 1,\n                "label": "medium",\n                "tag": "this is a medium quality stream",\n                "info": {\n                    "bitrate": 800,\n                    "width": 864,\n                    "height": 480,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-play.nanocosmos.de/play",\n                        "streamname": "XXXXX-YYYY1"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                        "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                        "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n                    },\n                    "token": "",\n                    "security": {}\n                },\n                "bintu": {}\n            },\n            {\n                "index": 2,\n                "label": "low",\n                "tag": "this is a low quality stream",\n                "info": {\n                    "bitrate": 400,\n                    "width": 426,\n                    "height": 240,\n                    "framerate": 15\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-play.nanocosmos.de/play",\n                        "streamname": "XXXXX-YYYY2"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                        "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                        "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n                    },\n                    "token": "",\n                    "security": {}\n                },\n                "bintu": {}\n            }\n        ],\n        "options": {\n            "adaption": {\n                "rule": "deviationOfMean2" // enable ABR\n            },\n            "switch": {\n                \'method\': \'server\',\n                \'pauseOnError\': false,\n                \'forcePlay\': true,\n                \'fastStart\': false,\n                \'timeout\': 10,\n            }\n        },\n        "startIndex": 2 // lowest\n    },\n    "playback": {\n        ...\n    },\n    "style": {\n        ...\n    }\n};\n')),(0,i.yg)("admonition",{title:"Note",type:"info"},(0,i.yg)("p",{parentName:"admonition"}," In case you either provide an invalid ",(0,i.yg)("inlineCode",{parentName:"p"},"startIndex")," or don't provide one at all the player starts the stream with index 0. ",(0,i.yg)("br",null),"\nThe player will set the default adaption rule none if no adaption rule is passed. You can still switch between your pre-configured entries manually with the switchStream API.")),(0,i.yg)("h4",{id:"example-multi-stream-configuration-with-abr-and-playback-security"},"Example multi stream configuration (with ABR) and playback security"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var config = {\n    "source" : {\n        "entries": [ // array of \'entry\' objects\n            {\n                "index": 0,\n                "label": "high",\n                "tag": "this is a high quality stream",\n                "info": {\n                    "bitrate": 1200,\n                    "width": 1280,\n                    "height": 720,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-splay.nanocosmos.de/splay",\n                        "streamname": "XXXXX-YYYY0"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live-secure.nanocosmos.de:443/h5live/authstream/stream.mp4",\n                        "hls": "https://bintu-h5live-secure.nanocosmos.de:443/h5live/authhttp/playlist.m3u8",\n                        "progressive": "https://bintu-h5live-secure.nanocosmos.de:443/h5live/authhttp/stream.mp4"\n                    },\n                    "token": "",\n                    // security for streamname XXXXX-YYYY0 here\n                    "security": {\n                        "token": "TOKEN_HERE",\n                        "expires": "EXPIRES_HERE",\n                        "options": "OPTIONS_HERE",\n                        "tag": "TAG_HERE"\n                    }\n                },\n                "bintu": {}\n            },\n            {\n                "index": 1,\n                "label": "medium",\n                "tag": "this is a medium quality stream",\n                "info": {\n                    "bitrate": 800,\n                    "width": 864,\n                    "height": 480,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-splay.nanocosmos.de/splay",\n                        "streamname": "XXXXX-YYYY1"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live-secure.nanocosmos.de:443/h5live/authstream/stream.mp4",\n                        "hls": "https://bintu-h5live-secure.nanocosmos.de:443/h5live/authhttp/playlist.m3u8",\n                        "progressive": "https://bintu-h5live-secure.nanocosmos.de:443/h5live/authhttp/stream.mp4"\n                    },\n                    "token": "",\n                    // security for streamname XXXXX-YYYY1 here\n                    "security": {\n                        "token": "TOKEN_HERE",\n                        "expires": "EXPIRES_HERE",\n                        "options": "OPTIONS_HERE",\n                        "tag": "TAG_HERE"\n                    }\n                },\n                "bintu": {}\n            },\n            {\n                "index": 2,\n                "label": "low",\n                "tag": "this is a low quality stream",\n                "info": {\n                    "bitrate": 400,\n                    "width": 426,\n                    "height": 240,\n                    "framerate": 15\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-splay.nanocosmos.de/splay",\n                        "streamname": "XXXXX-YYYY2"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live-secure.nanocosmos.de:443/h5live/authstream/stream.mp4",\n                        "hls": "https://bintu-h5live-secure.nanocosmos.de:443/h5live/authhttp/playlist.m3u8",\n                        "progressive": "https://bintu-h5live-secure.nanocosmos.de:443/h5live/authhttp/stream.mp4"\n                    },\n                    "token": "",\n                    // security for streamname XXXXX-YYYY2 here\n                    "security": {\n                        "token": "TOKEN_HERE",\n                        "expires": "EXPIRES_HERE",\n                        "options": "OPTIONS_HERE",\n                        "tag": "TAG_HERE"\n                    }\n                },\n                "bintu": {}\n            }\n        ],\n        "options": {\n            "adaption": {\n                "rule": "deviationOfMean2" // enable ABR\n            },\n            "switch": {\n                \'method\': \'server\',\n                \'pauseOnError\': false,\n                \'forcePlay\': true,\n                \'fastStart\': false,\n                \'timeout\': 10,\n            }\n        },\n        "startIndex": 2 // lowest\n    },\n    "playback": {\n        ...\n    },\n    "style": {\n        ...\n    }\n};\n')),(0,i.yg)("h4",{id:"example-bintu-multi-stream-configuration-with-abr"},"Example bintu multi stream configuration (with ABR)"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var config = {\n    "source" : {\n        "entries": [ // array of \'entry\' objects\n            {\n                "index": 0,\n                "label": "high",\n                "tag": "this is a high quality stream",\n                "info": {\n                    "bitrate": 1200,\n                    "width": 1280,\n                    "height": 720,\n                    "framerate": 30\n                },\n                "hls": "",\n                "bintu": {\n                    "streamid": "XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY0"\n                }\n            },\n            {\n                "index": 1,\n                "label": "medium",\n                "tag": "this is a medium quality stream",\n                "info": {\n                    "bitrate": 800,\n                    "width": 864,\n                    "height": 480,\n                    "framerate": 30\n                },\n                "hls": "",\n                "bintu": {\n                    "streamid": "XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY1"\n                }\n            },\n            {\n                "index": 2,\n                "label": "low",\n                "tag": "this is a low quality stream",\n                "info": {\n                    "bitrate": 400,\n                    "width": 426,\n                    "height": 240,\n                    "framerate": 15\n                },\n                "hls": "",\n                "bintu": {\n                    "streamid": "XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY2"\n                }\n            }\n        ],\n        "options": {\n            "adaption": {\n                "rule": "deviationOfMean2" // enable ABR\n            },\n            "switch": {\n                \'method\': \'server\',\n                \'pauseOnError\': false,\n                \'forcePlay\': true,\n                \'fastStart\': false,\n                \'timeout\': 10,\n            }\n        },\n        "startIndex": 2 // lowest\n    },\n    "playback": {\n        ...\n    },\n    "style": {\n        ...\n    }\n};\n')),(0,i.yg)("h4",{id:"example-bintu-multi-stream-configuration-with-abr-and-playback-security"},"Example bintu multi stream configuration (with ABR) and playback security"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var config = {\n    "source" : {\n        "entries": [ // array of \'entry\' objects\n            {\n                "index": 0,\n                "label": "high",\n                "tag": "this is a high quality stream",\n                "info": {\n                    "bitrate": 1200,\n                    "width": 1280,\n                    "height": 720,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    // security for bintu streamid XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY0 here\n                    "security": {\n                        "token": "TOKEN_HERE",\n                        "expires": "EXPIRES_HERE",\n                        "options": "OPTIONS_HERE",\n                        "tag": "TAG_HERE"\n                    }\n                },\n                "bintu": {\n                    "streamid": "XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY0"\n                }\n            },\n            {\n                "index": 1,\n                "label": "medium",\n                "tag": "this is a medium quality stream",\n                "info": {\n                    "bitrate": 800,\n                    "width": 864,\n                    "height": 480,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    // security for bintu streamid XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY1 here\n                    "security": {\n                        "token": "TOKEN_HERE",\n                        "expires": "EXPIRES_HERE",\n                        "options": "OPTIONS_HERE",\n                        "tag": "TAG_HERE"\n                    }\n                },\n                "bintu": {\n                    "streamid": "XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY1"\n                }\n            },\n            {\n                "index": 2,\n                "label": "low",\n                "tag": "this is a low quality stream",\n                "info": {\n                    "bitrate": 400,\n                    "width": 426,\n                    "height": 240,\n                    "framerate": 15\n                },\n                "hls": "",\n                "h5live": {\n                    // security for bintu streamid XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY2 here\n                    "security": {\n                        "token": "TOKEN_HERE",\n                        "expires": "EXPIRES_HERE",\n                        "options": "OPTIONS_HERE",\n                        "tag": "TAG_HERE"\n                    }\n                },\n                "bintu": {\n                    "streamid": "XXXXXXXX-XXXX-XXXX-XXXX-YYYYYYYYYYY2"\n                }\n            }\n        ],\n        "options": {\n            "adaption": {\n                "rule": "deviationOfMean2" // enable ABR\n            },\n            "switch": {\n                \'method\': \'server\',\n                \'pauseOnError\': false,\n                \'forcePlay\': true,\n                \'fastStart\': false,\n                \'timeout\': 10,\n            }\n        },\n        "startIndex": 2 // lowest\n    },\n    "playback": {\n        ...\n    },\n    "style": {\n        ...\n    }\n};\n')),(0,i.yg)("h3",{id:"switch-options"},"Switch options"),(0,i.yg)("p",null,"There are multiple possible switch options that can be set directly over the ",(0,i.yg)("inlineCode",{parentName:"p"},"config.source.options.switch")," object."),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Possible options"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"method"),": ",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"The preferred switching method"),(0,i.yg)("li",{parentName:"ul"},"Possible values are ",(0,i.yg)("strong",{parentName:"li"},"'server'")," (default) and ",(0,i.yg)("strong",{parentName:"li"},"'client'")))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"pauseOnError"),": ",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"If set the player stops in case an error occurs during the process of stream switching"),(0,i.yg)("li",{parentName:"ul"},"Possible values are ",(0,i.yg)("strong",{parentName:"li"},"false")," (default) and ",(0,i.yg)("strong",{parentName:"li"},"true")))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"forcePlay"),": ",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"If set the player starts the playback even though the player is in ",(0,i.yg)("inlineCode",{parentName:"li"},"paused")," state"),(0,i.yg)("li",{parentName:"ul"},"Possible values are ",(0,i.yg)("strong",{parentName:"li"},"false")," and ",(0,i.yg)("strong",{parentName:"li"},"true")," (default) "))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"timeout"),": ",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"The maximal time to wait in ",(0,i.yg)("strong",{parentName:"li"},"seconds")," before running into a timeout"),(0,i.yg)("li",{parentName:"ul"},"If the time limit is reached the ",(0,i.yg)("strong",{parentName:"li"},"error 4006")," will be thrown inside the ",(0,i.yg)("a",{parentName:"li",href:"./nanoplayer_api#onswitchstreamfail"},(0,i.yg)("inlineCode",{parentName:"a"},"onSwitchStreamFail"))," event"),(0,i.yg)("li",{parentName:"ul"},"The default value is ",(0,i.yg)("strong",{parentName:"li"},"10")," seconds and the possible range is between ",(0,i.yg)("strong",{parentName:"li"},"5")," and ",(0,i.yg)("strong",{parentName:"li"},"30")," seconds"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"tag"),": ",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"This custom field can be any ",(0,i.yg)("strong",{parentName:"li"},"string")," you like and will be returned in all of the switchStream completion events. (",(0,i.yg)("a",{parentName:"li",href:"./nanoplayer_api#onswitchstreamsuccess"},(0,i.yg)("inlineCode",{parentName:"a"},"onSwitchStreamSuccess")),", ",(0,i.yg)("a",{parentName:"li",href:"./nanoplayer_api#onswitchstreamfail"},(0,i.yg)("inlineCode",{parentName:"a"},"onSwitchStreamFail"))," and ",(0,i.yg)("a",{parentName:"li",href:"./nanoplayer_api#onswitchstreamabort"},(0,i.yg)("inlineCode",{parentName:"a"},"onSwitchStreamAbort")),")")))),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},"You can find more specific information on the possible options ",(0,i.yg)("a",{parentName:"p",href:"./nanoplayer_api#nanoplayerupdatesourcesource---codepromiseltconfigerrorgtcode"},"here"),".")),(0,i.yg)("h2",{id:"automatic-bitrate-adaption-abr"},"Automatic bitrate adaption (ABR)"),(0,i.yg)("p",null,"The nanoStream H5Live Player automatic bitrate adaption (ABR) feature decides which quality to play, to accommodate your users' network situation and avoid bufferings and frame drops."),(0,i.yg)("h3",{id:"how-to-use"},"How to use"),(0,i.yg)("p",null,"The following steps are required to setup the nanoStream H5Live Player with automatic bitrate adaption:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Configuration of two or more streams in ",(0,i.yg)("inlineCode",{parentName:"li"},"config.source.entries")," ",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"ordered by bitrate with ",(0,i.yg)("strong",{parentName:"li"},"index zero")," holding the ",(0,i.yg)("strong",{parentName:"li"},"highest bitrate")))),(0,i.yg)("li",{parentName:"ul"},"The order is determined by the ",(0,i.yg)("inlineCode",{parentName:"li"},"index")," property, ",(0,i.yg)("strong",{parentName:"li"},"not")," by the position in the list"),(0,i.yg)("li",{parentName:"ul"},"Selecting the initial stream/rendition by assigning the index to ",(0,i.yg)("inlineCode",{parentName:"li"},"config.source.startIndex")," "),(0,i.yg)("li",{parentName:"ul"},"Assigning an adaption rule other than ",(0,i.yg)("inlineCode",{parentName:"li"},"none")," to ",(0,i.yg)("inlineCode",{parentName:"li"},"config.source.options.adaption.rule")," "),(0,i.yg)("li",{parentName:"ul"},"Currently available adaption rules are:",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"none")," - Manual switching"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"deviationOfMean")," - Buffer based bitrate adaption rule"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"deviationOfMean2")," - Enhanced buffer based bitrate adaption rule (added in v4.5)")))),(0,i.yg)("p",null,"To choose the right quality to start with highly depends on the available qualities and the use case. ",(0,i.yg)("br",null)," A very common way is to not start with the highest (eg. medium/low) quality. Therefore there is an ",(0,i.yg)("strong",{parentName:"p"},"intial switch up")," mechanism that switches to a higher quality until the matching quality for the present bandwidth is found. "),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},"This happens ",(0,i.yg)("strong",{parentName:"p"},"only")," on the initialization of the player and won't happen if you chose to start with the highest quality (index 0) by default.")),(0,i.yg)("h3",{id:"example-multi-stream-configuration-with-abr-1"},"Example multi stream configuration (with ABR)"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var config = {\n    "source" : {\n        "entries": [ // array of \'entry\' objects\n            {\n                "index": 0,\n                "label": "high",\n                "tag": "this is a high quality stream",\n                "info": {\n                    "bitrate": 1200,\n                    "width": 1280,\n                    "height": 720,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-play.nanocosmos.de/play",\n                        "streamname": "XXXXX-YYYY0"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                        "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                        "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n                    },\n                    "token": "",\n                    "security": {}\n                },\n                "bintu": {}\n            },\n            {\n                "index": 1,\n                "label": "medium",\n                "tag": "this is a medium quality stream",\n                "info": {\n                    "bitrate": 800,\n                    "width": 864,\n                    "height": 480,\n                    "framerate": 30\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-play.nanocosmos.de/play",\n                        "streamname": "XXXXX-YYYY1"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                        "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                        "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n                    },\n                    "token": "",\n                    "security": {}\n                },\n                "bintu": {}\n            },\n            {\n                "index": 2,\n                "label": "low",\n                "tag": "this is a low quality stream",\n                "info": {\n                    "bitrate": 400,\n                    "width": 426,\n                    "height": 240,\n                    "framerate": 15\n                },\n                "hls": "",\n                "h5live": {\n                    "rtmp": {\n                        "url": "rtmp://bintu-play.nanocosmos.de/play",\n                        "streamname": "XXXXX-YYYY2"\n                    },\n                    "server": {\n                        "websocket": "wss://bintu-h5live.nanocosmos.de:443/h5live/stream.mp4",\n                        "hls": "https://bintu-h5live.nanocosmos.de:443/h5live/http/playlist.m3u8",\n                        "progressive": "https://bintu-h5live.nanocosmos.de:443/h5live/http/stream.mp4"\n                    },\n                    "token": "",\n                    "security": {}\n                },\n                "bintu": {}\n            }\n        ],\n        "options": {\n            "adaption": {\n                "rule": "deviationOfMean2" // enable ABR\n            },\n            "switch": {\n                \'method\': \'server\',\n                \'pauseOnError\': false,\n                \'forcePlay\': true,\n                \'fastStart\': false,\n                \'timeout\': 10,\n            }\n        },\n        "startIndex": 2 // lowest\n    },\n    "playback": {\n        ...\n    },\n    "style": {\n        ...\n    }\n};\n')),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},"In case you either provide an invalid ",(0,i.yg)("inlineCode",{parentName:"p"},"startIndex")," or don't provide one at all the player starts the stream with index 0. ",(0,i.yg)("br",null),"\nThe player will set the default adaption rule none if no adaption rule is passed. You can still switch between your pre-configured entries manually with the switchStream API.")),(0,i.yg)("h2",{id:"switchstream-api"},"switchStream API"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"switchStream")," feature enables the application/viewer to perform stream switches on the pre-configured stream list by referencing the index property of the target stream entry. "),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},"You can find more information on the switchStream API in our ",(0,i.yg)("a",{parentName:"p",href:"./nanoplayer_api#nanoplayerswitchstreamindex-%E2%87%92-codepromiseltconfigerrorgtcode"},"API documentation"),".")),(0,i.yg)("h3",{id:"how-to-use-1"},"How to use"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Configuration of two or more streams in ",(0,i.yg)("inlineCode",{parentName:"li"},"config.source.entries")),(0,i.yg)("li",{parentName:"ul"},"Selecting the initial stream by assigning the index to ",(0,i.yg)("inlineCode",{parentName:"li"},"config.source.startIndex")," "),(0,i.yg)("li",{parentName:"ul"},"Assigning the adaption rule ",(0,i.yg)("inlineCode",{parentName:"li"},"none")," to ",(0,i.yg)("inlineCode",{parentName:"li"},"config.source.options.adaption.rule")," "),(0,i.yg)("li",{parentName:"ul"},"Applying switches by calling ",(0,i.yg)("inlineCode",{parentName:"li"},"switchStream(index)")," with the index of the target stream entry "),(0,i.yg)("li",{parentName:"ul"},"Listening to related event notifications",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"onSwitchStreamInit"),(0,i.yg)("li",{parentName:"ul"},"onSwitchStreamSuccess"),(0,i.yg)("li",{parentName:"ul"},"onSwitchStreamAbort"),(0,i.yg)("li",{parentName:"ul"},"onSwitchStreamFail")))),(0,i.yg)("admonition",{type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"Manual switching via switchStream API will disable any further ABR controlled behavior. Use the ",(0,i.yg)("a",{parentName:"p",href:"#setadaption-api"},"setAdaption API")," to again reinitialize the automatic adaption. You can read more on how to combine automatic and manual switching ",(0,i.yg)("a",{parentName:"p",href:"#combined-abr-and-manual-switching"},"here"),".")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Example switchStream call:")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},"player.switchStream(1).then(function (config) {\n    console.log('switch stream initialized with config: ' + JSON.stringify(config));\n}, function (error) {\n    console.log(error);\n});\n")),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},"The switchStream API returns a promise that is rejected if the provided ",(0,i.yg)("inlineCode",{parentName:"p"},"index")," parameter is out of range.")),(0,i.yg)("h3",{id:"switchstream-events"},"switchStream events"),(0,i.yg)("p",null,"With the release of the ",(0,i.yg)("inlineCode",{parentName:"p"},"switchStream")," API there are also ",(0,i.yg)("strong",{parentName:"p"},"4")," new events you should listen to:"),(0,i.yg)("h4",{id:"start-event"},"Start Event"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"./nanoplayer_api#onswitchstreaminit"},"onSwitchStreamInit")),": This event signals an initialized switch stream request. This is ",(0,i.yg)("strong",{parentName:"li"},"only")," a start event that will be followed by one of the completion events.")),(0,i.yg)("h4",{id:"completion-events"},"Completion Events"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"nanoplayer_api#onswitchstreamsuccess"},"onSwitchStreamSuccess")),": This event signals a successful switch stream request and fires if the stream was switched. "),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"nanoplayer_api#onswitchstreamfail"},"onSwitchStreamFail")),": This event signals a failed switch stream request. Fired if an error occurs during the stream switch."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"nanoplayer_api#onswitchstreamabort"},"onSwitchStreamAbort")),": This event signals an aborted switch stream request. Possible reasons are an equal source (",(0,i.yg)("strong",{parentName:"li"},"'equalsource'"),"), a superseding (",(0,i.yg)("strong",{parentName:"li"},"'superseded'"),") or the time difference between two following ",(0,i.yg)("inlineCode",{parentName:"li"},"switchStream")," calls that is too small  (",(0,i.yg)("strong",{parentName:"li"},"'frequency'"),"). ")),(0,i.yg)("br",null),(0,i.yg)("admonition",{title:"Also, keep in mind...",type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"...there will be an ",(0,i.yg)("a",{parentName:"p",href:"./nanoplayer_api#onstreaminfo"},(0,i.yg)("inlineCode",{parentName:"a"},"onStreamInfo"))," event indicating that the first image of the new stream is getting played out.\t")),(0,i.yg)("h3",{id:"difference-switchstream-api--updatesource-api"},"Difference switchStream API / updateSource API"),(0,i.yg)("p",null,"The switchStream API allows to only choose between the pre-configured stream list (",(0,i.yg)("inlineCode",{parentName:"p"},"config.source.entries"),") by referencing the index of the entry while the updateSource API replaces the entire source (",(0,i.yg)("inlineCode",{parentName:"p"},"config.source"),") with a new source."),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"}," Click here to get more information on the ",(0,i.yg)("a",{parentName:"p",href:"./nanoplayer_update_source"},"updateSource API"))),(0,i.yg)("h2",{id:"setadaption-api"},"setAdaption API"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"setAdaption")," feature enables the application/viewer to change the adaption rule eg. from manually controlled to automatic switching behavior."),(0,i.yg)("p",null,"Currently available adaption rules are:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"none")," - Manual switching"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"deviationOfMean")," - Buffer based bitrate adaption rule"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"deviationOfMean2")," - Enhanced buffer based bitrate adaption rule (added in v4.5)")),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"You can find more information on the setAdaption API in our ",(0,i.yg)("a",{parentName:"p",href:"./nanoplayer_api#nanoplayersetadaptionadaption"},"API documentation"),".")),(0,i.yg)("h3",{id:"example-to-set-automatic-adaption"},"Example to set automatic adaption"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'// Player instance of NanoPlayer\nvar adaption = {\n    "rule": "deviationOfMean2"\n}\n\nplayer.setAdaption(adaption);\n')),(0,i.yg)("h3",{id:"combined-abr-and-manual-switching"},"Combined ABR and manual switching"),(0,i.yg)("p",null,"In case the nanoStream H5Live Player is configured to use ABR and a manual switch gets initialized via the switchStream API the automatic adaption is stopped. From this moment on the switching behavior is manually controlled."),(0,i.yg)("p",null,"To again reinitialize the automatic adaption use the ",(0,i.yg)("a",{parentName:"p",href:"#setadaption-api"},"setAdaption API")," with the name of the rule you want to set (eg. ",(0,i.yg)("inlineCode",{parentName:"p"},"deviationOfMean2"),")."))}h.isMDXComponent=!0}}]);